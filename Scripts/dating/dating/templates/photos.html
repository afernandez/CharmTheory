{% extends "base.html" %}
{% block title %}{{ user.nick }} Photos{% endblock %}

{% block content %}
{% block javascript %}
<script type="text/javascript">
    function upload_pic(event) {
        $("div#upload_box").show();
    }

    function cancel_upload(event) {
        $("div#upload_box").hide();
    }

    function reload_upload() {
        // Must be hidden after the form's events are set.
        $("input#upload_token").val("{{ csrf_token }}");
        $("div#upload_box").hide();
    }

    function delete_photo(name) {
        $("form#delete_photo input[name='file']").val(name);
        $("form#delete_photo").submit();
    }

    $(document).ready(function() {
        reload_upload();
    });
</script>
{% endblock %}
<div style="clear: both;">
    <h2>{{ user.nick }}</h2>

    <div id="customize_ajax">
        {% if error %}
            <span style="color: red;">{{ error }}</span>
        {% endif %}

        {% if new_photo %}
            <div id="new_photo">
                Successfully added photo. Try scaling it.
            </div>
        {% endif %}
        <a href="#" onclick="javascript:upload_pic(event);">Add</a>
        <div id="upload_box" style="height: 400px; border: 2px solid black;">
            <form id="upload" action="/photos/upload/" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="file" name="file_path" accept="image/*" size="50"/>
                <a href="#">Facebook</a>
                <a href="#">Dropbox</a>
                <a href="#">Instagram</a>
                <br/>
                <input type="submit" value="Upload">
                <a href="#" onclick="javascript:cancel_upload(event);">Cancel</a>
            </form>
        </div>
    </div>
    <form id="delete_photo" action="/photos/delete/" method="post">
        {% csrf_token %}
        <input type="hidden" name="file" value="" />
    </form>
    <div>
        {% for photo in user.user_photos %}
            <div>
                <img src="{{ photo.rel_path_l }}" />
                <a href="#" onclick="javascript:delete_photo('{{ photo.name }}')">delete (X)</a>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}